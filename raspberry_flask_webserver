from flask import Flask, request, render_template
import serial

app = Flask(__name__)

# 아두이노 
serial_port = '/dev/ttyACM0'
baud_rate = xxxx
arduino = serial.Serial(serial_port, baud_rate)


num_vehicles = 0

@app.route('/')
def index():
    global num_vehicles
    return render_template('index.html', num_vehicles=num_vehicles)

@app.route('/vehicle_count', methods=['POST'])
def vehicle_count():
    global num_vehicles
    num_vehicles = int(request.form['num_vehicles'])
    signal = 'extend' if num_vehicles >= 3 else 'normal'  # 임곗값 지정
    arduino.write(signal.encode() + b'\n')  
    print(f"Signal sent to Arduino: {signal}")
    return 'OK'


if __name__ == '__main__':
    app.run(host='0.0.0.0', port=xxxx)
